(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-drugCode-drug"],{"18c7":function(e,t,a){"use strict";var s=a("2b7b"),i=a.n(s);i.a},"2b7b":function(e,t,a){var s=a("2e8d");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var i=a("967d").default;i("c25e2fb2",s,!0,{sourceMap:!1,shadowMode:!1})},"2e8d":function(e,t,a){var s=a("c86c");t=s(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.scan-delete[data-v-0b6cbfbc] {height:100%}.scan-delete[data-v-0b6cbfbc] .tbody{height:calc(100% - %?50?%);max-height:calc(100% - %?50?%)}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card{overflow:inherit;z-index:99}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card .item-info{align-items:center;font-size:14px;color:#333}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card .item-info .uni-combox{height:100%}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card .item-info .uni-combox .uni-combox__label{font-size:14px;color:#333}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card .item-info .uni-combox .uni-combox__input{font-size:14px}.drug-code-wrap[data-v-0b6cbfbc] .drug-code-card .item-info .uni-combox__input-arrow{padding:2px}.drug-code-wrap[data-v-0b6cbfbc] .scan-box{margin:%?10?% %?20?%;word-break:break-all;position:relative;padding-bottom:%?70?%}.drug-code-wrap[data-v-0b6cbfbc] .scan-box .scan-number{position:absolute;bottom:%?10?%;left:%?10?%}.drug-code-wrap[data-v-0b6cbfbc] .scan-box .scan-more{position:absolute;bottom:%?10?%;right:%?10?%}.drug-code-wrap[data-v-0b6cbfbc] .uni-dialog-content{display:none}.drug-code-wrap[data-v-0b6cbfbc] .reasons{padding:%?10?% 0}.drug-code-wrap[data-v-0b6cbfbc] .reasons .radio{display:block;padding:%?10?% %?40?%}.drug-code-wrap[data-v-0b6cbfbc] .reasons .radio uni-radio .uni-radio-input{margin-right:%?30?%;margin-top:%?-8?%}',""]),e.exports=t},"6ec8":function(e,t,a){"use strict";a.r(t);var s=a("ecac"),i=a.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);t["default"]=i.a},"8e3e":function(e,t,a){"use strict";a.r(t);var s=a("c3ee"),i=a("6ec8");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("18c7");var o=a("828b"),c=Object(o["a"])(i["default"],s["b"],s["c"],!1,null,"0b6cbfbc",null,!1,s["a"],void 0);t["default"]=c.exports},c3ee:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return s}));var s={uniCard:a("4d76").default,uniCombox:a("69ec").default,rfForm:a("a460").default,rfInput:a("d184").default,rfTable:a("bdee").default,uniPopup:a("5885").default,uniDrawer:a("796c").default,uniIcons:a("5102").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("appContainer",{staticClass:"drug-code-wrap",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClose.apply(void 0,arguments)}}},[a("v-uni-scroll-view",{staticStyle:{height:"100%"},attrs:{"scroll-y":"true"}},[a("uni-card",{staticClass:"drug-code-card",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClose.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[a("v-uni-view",{staticClass:"uni-flex-item"},[e._v(e._s(e.label)+"："+e._s(e.casesPickInfo.orderId))])],1),a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[a("v-uni-view",{staticClass:"uni-flex-item"},[e._v(e._s("out"===e.casesPickInfo.type?"出库":"入库")+"类型："+e._s(e.casesPickInfo.typeName))]),a("v-uni-view",{staticClass:"uni-flex-item"},[e._v("批号："+e._s(e.casesPickInfo.GoodsBatch))])],1),a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[e._v("规格："+e._s(e.casesPickInfo.Model))]),a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[a("v-uni-view",{staticClass:"uni-flex-item"},[e._v("客户名称："+e._s(e.casesPickInfo.SupplierName))])],1),a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[e._v("厂牌："+e._s(e.casesPickInfo.Trade))]),a("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[e.isCasesPick?a("v-uni-view",{staticClass:"uni-flex-item"},[e._v("数量："+e._s(e.scanNumber+"/"+e.allScanNumber))]):e._e(),e.isCasesPick?e._e():a("v-uni-view",{staticClass:"uni-flex-item"},[e._v("零品："+e._s(e.yjmInfo.Quantity2))]),a("v-uni-view",{staticClass:"uni-flex-item"},[a("uni-combox",{ref:"combox",attrs:{label:"扫描包装：",disabled:e.isCasesPick,candidates:e.packOptions},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSelectPackageType.apply(void 0,arguments)}},model:{value:e.packType,callback:function(t){e.packType=t},expression:"packType"}})],1)],1)],1),a("rf-form",{staticStyle:{height:"auto"},attrs:{labelWidth:"120",focusField:e.focusField,overflow:!1}},["小"!==e.packType?a("rf-input",{attrs:{focus:e.focusField.sl,type:"number",label:"包装数"},on:{"update:focus":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.focusField,"sl",t)},input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSlInput.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.focusField.drugCode=!0}},model:{value:e.sl,callback:function(t){e.sl=t},expression:"sl"}}):e._e(),e.isYjm?a("rf-input",{attrs:{id:"drugCode",confirmHold:!0,focus:e.focusField.drugCode,label:"药监码",confirmType:"done",maxlength:20},on:{"update:focus":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.focusField,"drugCode",t)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCodeChange.apply(void 0,arguments)}},model:{value:e.drugCode,callback:function(t){e.drugCode=t},expression:"drugCode"}},[a("template",{slot:"extra"})],2):e._e(),"1"===e.$system.system&&e.casesPickInfo.SupplierSONO?a("v-uni-button",{staticClass:"m-r-20",staticStyle:{"margin-left":"20rpx"},attrs:{type:"default",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.GetOwnerYjm.apply(void 0,arguments)}}},[e._v("获取药监码")]):e._e()],1),a("v-uni-view",{staticClass:"uni-flex",staticStyle:{height:"auto"}},[a("v-uni-view",{staticClass:"uni-flex-item",staticStyle:{color:"#e60012",padding:"5rpx 20rpx","font-size":"12px"}},[e._v("注：超过100条时，请分批保存")]),e.sacnTable.length>0&&"out"===e.casesPickInfo.type?a("v-uni-view",{staticStyle:{"padding-right":"10rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleShowCode.apply(void 0,arguments)}}},[e._v("已扫药监码>>")]):e._e()],1),a("v-uni-view",{staticClass:"scan-box"},[e.scanNumber?a("v-uni-view",{staticClass:"scan-more f-primary",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleShowMore.apply(void 0,arguments)}}},[e._v("查看更多>>")]):e._e(),a("v-uni-view",{staticClass:"scan-number"},[e._v(e._s(e.scanNumber+"/"+e.allScanNumber))]),a("rf-table",{attrs:{columns:e.codeInfo.columns,"table-data":e.codeLists},scopedSlots:e._u([{key:"operation",fn:function(t){var s=t.item;return[a("v-uni-button",{staticClass:"table-opeartion-button",attrs:{size:"mini",type:"warn"},on:{touchend:function(t){t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.handleDelete(s)}}},[e._v("删除")])]}}])})],1)],1),a("template",{slot:"footer"},[a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClear.apply(void 0,arguments)}}},[e._v("清空")]),e.allScanNumber>e.scanNumber&&"1"===e.$system.system?a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleTempSubmit.apply(void 0,arguments)}}},[e._v("临时保存")]):e._e(),e.allScanNumber===e.scanNumber?a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmit.apply(void 0,arguments)}}},[e._v("保存")]):e.pageData.SkipToCompletePower?a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"default"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleComplete.apply(void 0,arguments)}}},[e._v("强制完成")]):e._e()],1),a("uni-popup",{ref:"popup",attrs:{type:"dialog"}},[a("uni-popup-dialog",{attrs:{title:"原因",duration:2e3,"before-close":!0},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)}}},[a("v-uni-radio-group",{staticClass:"reasons",attrs:{slot:"content"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleRadioChange.apply(void 0,arguments)}},slot:"content"},[a("v-uni-label",{staticClass:"radio"},[a("v-uni-radio",{attrs:{value:"1",checked:"1"===e.reason}}),e._v("不是监管码品种")],1),a("v-uni-label",{staticClass:"radio"},[a("v-uni-radio",{attrs:{value:"2",checked:"2"===e.reason}}),e._v("扫足了未自动保存")],1),a("v-uni-label",{staticClass:"radio"},[a("v-uni-radio",{attrs:{value:"3",checked:"3"===e.reason}}),e._v("应扫数与实际数不符")],1),a("v-uni-label",{staticClass:"radio"},[a("v-uni-radio",{attrs:{value:"4",checked:"4"===e.reason}}),e._v("监管码保存错误")],1),a("v-uni-label",{staticClass:"radio"},[a("v-uni-radio",{attrs:{value:"5",checked:"5"===e.reason}}),e._v("其他原因（慎选）")],1)],1)],1)],1),a("uni-drawer",{ref:"scanPopup",staticClass:"full-uni-drawer",attrs:{mode:"right","mask-click":!0,width:"90%"}},[a("v-uni-view",{staticClass:"uni-flex uni-column"},[a("v-uni-view",{staticClass:"f-36 f-b t-c p-t-20 p-b-20 uni-flex",staticStyle:{height:"auto"}},[a("uni-icons",{staticClass:"drawer-close f-n",attrs:{type:"arrowleft",size:"24"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCloseScan.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-flex-item",staticStyle:{"text-align":"center"}},[e._v("已扫药监码")])],1),a("v-uni-scroll-view",{staticClass:"uni-flex-item",staticStyle:{overflow:"auto"},attrs:{"scroll-y":"true"}},[a("v-uni-view",[a("rf-table",{staticClass:"m-r-20 m-l-20 scan-delete",attrs:{columns:e.scanColumns,"table-data":e.sacnTable}})],1)],1),a("v-uni-view",{staticClass:"uni-flex",staticStyle:{height:"auto"}},[a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCloseScan.apply(void 0,arguments)}}},[e._v("关闭")]),a("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDeleteScan.apply(void 0,arguments)}}},[e._v("删除")])],1)],1)],1)],2)},n=[]},ecac:function(e,t,a){"use strict";a("6a54");var s=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bf0f"),a("2797"),a("64aa"),a("f7a5"),a("dc69"),a("8f71"),a("fd3c"),a("c223"),a("5c47"),a("0506"),a("bd06"),a("aa9c"),a("dc8a");var i=s(a("9b1b")),n=s(a("b7c7")),o=s(a("4d76")),c=s(a("69ec")),u=s(a("9a9a")),d=s(a("b93a")),r=s(a("ceba")),l=s(a("5885")),f=s(a("a347")),h=a("8f59"),p=a("1f2e"),m={name:"drugCode",data:function(){return{isDelete:!1,label:"",reason:"",packType:"小",drugCode:"",caseCode:"",codeList:[],sl:1,slC:1,timmer:"",isKeydown:!1,pageData:"",isYjm:!0,count:0,codeInfo:{columns:[{name:"条码",dataIndex:"barcode"},{name:"类型",dataIndex:"package",width:100},{name:"数量",dataIndex:"count",width:100},{name:"操作",dataIndex:"operation",width:120}]},scanColumns:[{name:"条码",dataIndex:"barcode"},{name:"类型",dataIndex:"package",width:100},{name:"数量",dataIndex:"sl",width:100}],focusField:{sl:!1,drugCode:!1}}},onShow:function(e,t){this.codeList=this.codeListStore&&(0,n.default)(this.codeListStore)||[],this.scanCodeInfo&&this.scanCodeInfo.codeLists.length>0&&(this.codeList=this.scanCodeInfo.codeLists),this.clearScanCodeInfo(),this.setCodeLists([])},onHide:function(){this.setCodeLists(this.codeList)},computed:(0,i.default)((0,i.default)({},(0,h.mapGetters)({casesPickInfo:"casesPickInfo",userInfo:"userInfo",codeListStore:"codeList",scanCodeInfo:"scanCodeInfo"})),{},{packOptions:function(){return["小","中","大"]},isCasesPick:function(){return!0},allScanNumber:function(){var e=this.isCasesPick?"Quantity":"Quantity2",t=0;return this.pageData&&this.pageData.ScanSum_YJM.length>0&&this.pageData.ScanSum_YJM.forEach((function(e){t+=Number(e.sl)})),this.casesPickInfo[e]-t},scanNumber:function(){var e=0;return this.codeList.forEach((function(t){e+=Number(t.count)})),e},yjmInfo:function(){return this.casesPickInfo},codeLists:function(){var e=this.codeList;return e.reverse().slice(0,50)},sacnTable:function(){return this.pageData&&this.pageData.ScanSum_YJM||[]}}),components:{uniCard:o.default,uniCombox:c.default,uniBadge:u.default,uniTag:d.default,uniPopup:l.default,uniPopupDialog:f.default},onBackPress:function(e){var t=this;return"navigateBack"!==e.from&&(this.$showModel({showCancel:!0,message:"确认退出操作？",success:function(){t.setCodeLists([]),t.$back()}}),!0)},watch:{allScanNumber:function(e){e<=0&&this.handleYJMScan()},isYjm:function(e){uni.setNavigationBarTitle({title:e?"药监码":"箱序码"}),this.changeFocus(e?"drugCode":"caseCode")}},created:function(){this.loadData(),this.label="out"===this.casesPickInfo.type?"0"===this.$system.system?"出库订单号":"拣货单ID":"0"===this.$system.system?"入库订单号":"收货单ID"},methods:(0,i.default)((0,i.default)({},(0,h.mapActions)({setCasesPickInfo:"setCasesPickInfo",setCodeLists:"setCodeLists",setScanCodeInfo:"setScanCodeInfo",clearScanCodeInfo:"clearScanCodeInfo"})),{},{goScan:function(){this.clearScanCodeInfo(),this.sl?(this.setScanCodeInfo({codeLists:this.codeList||[],allScanNumber:this.allScanNumber,count:"小"!==this.packType?Number(this.sl):1,xxm:this.isYjm?"10":"01",isYjm:this.isYjm,picktype:this.isCasesPick?"1":"0",package:this.packType,sacnCodeLists:this.pageData&&(this.isYjm?this.pageData.ScanSum_YJM:this.pageData.ScanSum_XXM)||[]}),this.$navigateTo("/pages/drugCode/scanCode")):this.$simpleToast("请输入包装数")},handleShowCode:function(){this.$refs.scanPopup.open()},handleCloseScan:function(){this.$refs.scanPopup.close()},handleDeleteScan:function(){var e=this;r.default.DeleteTempYjm({OutStockNo:this.casesPickInfo.orderId,Owner:this.casesPickInfo.Owner,Iodtlid:this.casesPickInfo.Iodtlid,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,StockOutType:this.casesPickInfo.formType}).then((function(t){e.$simpleToast("删除成功"),e.loadData(),e.handleCloseScan()}))},handleShowMore:function(){this.setCodeLists(this.codeList),this.$navigateTo("/pages/drugCode/code")},loadData:function(){var e=this;this.packType="0"!==this.casesPickInfo.BigpackageNum?"大":"0"!==this.casesPickInfo.MidpackageNum?"中":"小",this.slC=this.sl="中"===this.packType?Number(this.casesPickInfo.MidpackageNum):"大"===this.packType?Number(this.casesPickInfo.BigpackageNum):1,this.isYjm=!0,this.changeFocus(this.isYjm?"drugCode":"caseCode");var t="out"===this.casesPickInfo.type?"ShowDataOut":"ShowDataIn",a={Iodtlid:this.casesPickInfo.Iodtlid||"",GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Owner:this.casesPickInfo.Owner,OperMan:this.userInfo.UserID};"out"===this.casesPickInfo.type?(a.OutStockNo=this.casesPickInfo.orderId,a.outformType=this.casesPickInfo.formType||""):(a.InStockNo=this.casesPickInfo.orderId,a.InformType=this.casesPickInfo.formType||""),r.default[t](a).then((function(t){e.pageData=t}))},handleComplete:function(){this.$refs.popup.open()},confirm:function(e){if(this.reason){var t="out"===this.casesPickInfo.type?"SkipToComplete":"SkipToCompleteIn";this.saveBarcodeSave(t,e,"1")}else this.$simpleToast("请选择强制完成原因")},close:function(e){this.reason="",e()},handleDelete:function(e){this.codeList=this.codeList.filter((function(t){return t.barcode!==e.barcode}))},handleClose:function(){this.$refs.combox.onBlur()},handleSlInput:function(e){var t=this;e<0&&(this.$simpleToast("包装数必须大于0"),setTimeout((function(){t.sl=""})))},handleCodeChange:function(e){var t=e.currentType;this.sl?!this.isDelete&&this.sl>this.allScanNumber-this.scanNumber?this.$simpleToast("包装数不能大于可扫描数量"):"drugCode"!==t?e.value?this.groupCodeData(e):this.$simpleToast("请输入或者扫描箱序码"):this.checkDrugCode(e):this.$simpleToast("请输入包装数")},handleTempSubmit:function(){var e=this,t="out"===this.casesPickInfo.type?"TempSaveOut":"TempSaveIn",a=(this.isYjm?this.pageData.ScanSum_YJM:this.pageData.ScanSum_XXM,this.setPostData());r.default[t](a).then((function(t){e.reason="";var a=e.codeList.map((function(e){return{package:e.package,barcode:e.barcode,picktype:e.picktype,sl:e.count,xxm:e.xxm}}));e.pageData.ScanSum_YJM=[].concat((0,n.default)(e.pageData.ScanSum_YJM),(0,n.default)(a)),e.handleClear(),setTimeout((function(){e.focusField.drugCode=!0}),200)}))},handleSubmit:function(){var e="out"===this.casesPickInfo.type?"BarcodeSave":"BarcodeSaveIn";this.saveBarcodeSave(e)},handleYJMScan:function(){this.codeList=[],this.isYjm?this.isYjm&&("1"===this.yjmInfo.Scanflg2&&(this.isYjm=!1),this.handleCheckScan()):this.handleCheckScan()},handleCheckScan:function(){this.setCasesPickInfo({isSave:!0}),this.$back()},setPostData:function(){return"out"===this.casesPickInfo.type?{Iodtlid:this.casesPickInfo.Iodtlid||"",StockOutType:this.casesPickInfo.formType,Owner:this.casesPickInfo.Owner,Po:this.casesPickInfo.orderId,Supplier:this.casesPickInfo.Supplier,OutformNo:this.casesPickInfo.orderId,OutStockNo:this.casesPickInfo.orderId,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Opcode:"0602",OperMan:this.userInfo.UserID,StockOutDate:new Date,PalletID:"",ScanBarcode:this.codeList,CodeCount:this.allScanNumber,xxm:this.isYjm?"10":"01",ForceType:this.reason}:{Iodtlid:this.casesPickInfo.Iodtlid||"",StockInType:this.casesPickInfo.formType,Owner:this.casesPickInfo.Owner,Po:this.casesPickInfo.orderId,Supplier:this.casesPickInfo.Supplier,InformNo:this.casesPickInfo.orderId,InStockNo:this.casesPickInfo.orderId,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Opcode:"0601",OperMan:this.userInfo.UserID,StockInDate:new Date,PalletID:"",ScanBarcode:this.codeList,CodeCount:this.allScanNumber,xxm:this.isYjm?"10":"01",ForceType:this.reason}},saveBarcodeSave:function(e,t,a){var s=this,i=(this.isYjm?this.pageData.ScanSum_YJM:this.pageData.ScanSum_XXM,this.setPostData());r.default[e](i).then((function(e){s.reason="",t&&t(),s.setCasesPickInfo({ScanComplete:a||"2"}),s.handleCheckScan()}))},handleClear:function(){this.codeList=[],this.isDelete=!1},checkDrugCode:function(e){this[e.currentType]?this.groupCodeData(e):this.$simpleToast("请输入或者扫描药监码")},handleErrorVideo:function(){var e=uni.createInnerAudioContext();e.autoplay=!0,e.src="../../static/video/error.mp3",e.onPlay((function(){console.log("开始播放")})),e.onError((function(e){console.log(e.errMsg),console.log(e.errCode)}))},groupCodeData:function(e){var t=this,a=this.pageData&&(this.isYjm?this.pageData.ScanSum_YJM:this.pageData.ScanSum_XXM)||[];if(this.isYjm&&!/^[\d]{20}$/.test(e.value))this.handleErrorVideo(),this.$simpleToast("药监码格式错误");else if((a.length<=0||a.findIndex((function(t){return t.barcode===e.value}))<=-1)&&this.codeList.findIndex((function(t){return t.barcode===e.value}))<=-1){if(this.isDelete&&this.sl>this.allScanNumber-this.scanNumber)return void this.$simpleToast("包装数不能大于可扫描数量");var s={barcode:e.value,count:"小"!==this.packType?Number(this.sl):1,xxm:this.isYjm?"10":"01",picktype:this.isCasesPick?"1":"0",package:this.packType};this.codeList.push(s)}else this.handleErrorVideo(),!this.isDelete&&this.$simpleToast(e.value+"已扫描"),this.isDelete&&this.$showModel({showCancel:!0,message:"确认删除药监码".concat(e.value,"？"),success:function(){t.codeList=t.codeList.filter((function(t){return t.barcode!==e.value}))}});setTimeout((function(){t[e.currentType]=""}))},handleSelectPackageType:function(e){this.slC=this.sl="中"===e?Number(this.casesPickInfo.MidpackageNum):"大"===e?Number(this.casesPickInfo.BigpackageNum):1,"小"===e||"0"!==this.casesPickInfo.MidpackageNum&&"0"!==this.casesPickInfo.BigpackageNum||this.changeFocus("sl")},changeFocus:function(e){var t=this;this.$nextTick((function(){Object.keys(t.focusField).forEach((function(a){t.focusField[a]=a===e}))}))},handleRadioChange:function(e){this.reason=e.target.value},GetOwnerYjm:function(){var e=this;r.default.GetOwnerYjm({OutStockNo:this.casesPickInfo.SupplierSONO,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Owner:this.casesPickInfo.SupplierOwner}).then((function(t){e.codeList=[];var a=e.pageData&&(e.isYjm?e.pageData.ScanSum_YJM:e.pageData.ScanSum_XXM)||[];t.ScanSum_YJM.length>0&&t.ScanSum_YJM.forEach((function(t){var a={barcode:t.barcode,count:t.sl,xxm:t.xxm,picktype:t.picktype,package:t.package};e.codeList.push(a)})),e.codeList=(0,p.getResultArray)("barcode","difference",e.codeList,a),e.setCodeLists(e.codeList),e.codeList.length>0&&(e.isDelete=!0)}))}})};t.default=m}}]);