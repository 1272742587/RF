(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-rferp-drug"],{"02e1":function(e,t,n){"use strict";n.r(t);var a=n("3d7e"),i=n("5b58");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("4987");var s=n("828b"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"1ac1f2bf",null,!1,a["a"],void 0);t["default"]=r.exports},1091:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var a={uniSegmentedControl:n("02e1").default,rfEmpty:n("ba77").default,uniCard:n("4d76").default,uniCombox:n("69ec").default,rfForm:n("a460").default,rfInput:n("d184").default,rfTable:n("bdee").default,uniPopup:n("5885").default,uniDrawer:n("796c").default,uniIcons:n("5102").default},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("appContainer",{staticClass:"drug-code-wrap",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleComBoxClose.apply(void 0,arguments)}}},[n("v-uni-scroll-view",{staticStyle:{height:"100%"},attrs:{"scroll-y":"true"}},[n("v-uni-view",{staticClass:"barcode-type"},[n("uni-segmented-control",{attrs:{current:e.barcodeType,values:e.barcodeMap,"style-type":"button"},on:{clickItem:function(t){arguments[0]=t=e.$handleEvent(t),e.onChangeBarcodeType.apply(void 0,arguments)}}})],1),e.isCurrentScanComplete?[n("rf-empty",{attrs:{emptyText:"无可扫码数据"}})]:[n("uni-card",{staticClass:"drug-code-card",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleComBoxClose.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[n("v-uni-view",{staticClass:"uni-flex-item"},[e._v(e._s(e.label)+"："+e._s(e.casesPickInfo.orderId))])],1),n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[n("v-uni-view",{staticClass:"uni-flex-item"},[e._v(e._s("out"===e.casesPickInfo.type?"出库":"入库")+"类型："+e._s(e.casesPickInfo.typeName))]),n("v-uni-view",{staticClass:"uni-flex-item"},[e._v("批号："+e._s(e.casesPickInfo.GoodsBatch))])],1),n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[e._v("规格："+e._s(e.casesPickInfo.Model))]),n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[n("v-uni-view",{staticClass:"uni-flex-item"},[e._v("客户名称："+e._s(e.casesPickInfo.SupplierName))])],1),n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[e._v("厂牌："+e._s(e.casesPickInfo.Trade))]),n("v-uni-view",{staticClass:"uni-flex uni-row item-info"},[n("v-uni-view",{staticClass:"uni-flex-item"},[e._v("数量："+e._s(e.scanNumber+"/"+e.allScanNumber))]),n("v-uni-view",{staticClass:"uni-flex-item"},[n("uni-combox",{ref:"combox",attrs:{label:"扫描包装：",disabled:!0,candidates:["小","中","大"]},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSelectPackageType.apply(void 0,arguments)}},model:{value:e.packType,callback:function(t){e.packType=t},expression:"packType"}})],1)],1)],1),n("rf-form",{staticStyle:{height:"auto"},attrs:{labelWidth:"120",focusField:e.focusField,overflow:!1}},["小"!==e.packType?n("rf-input",{attrs:{focus:e.focusField.sl,type:"number",label:"包装数"},on:{"update:focus":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.focusField,"sl",t)},input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSlInput.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.focusField.drugCode=!0}},model:{value:e.sl,callback:function(t){e.sl=t},expression:"sl"}}):e._e(),n("rf-input",{attrs:{id:"drugCode",confirmHold:!0,focus:e.focusField.drugCode,label:e.barcodeMap[e.barcodeType],confirmType:"done",maxlength:2==e.barcodeType?100:20},on:{"update:focus":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.focusField,"drugCode",t)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCodeChange.apply(void 0,arguments)}},model:{value:e.drugCode,callback:function(t){e.drugCode=t},expression:"drugCode"}}),"1"===e.$system.system&&e.casesPickInfo.SupplierSONO&&e.casesPickInfo.SupplierOwner?n("v-uni-button",{staticClass:"m-r-20",staticStyle:{"margin-left":"20rpx"},attrs:{type:"default",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.GetOwnerYjm.apply(void 0,arguments)}}},[e._v("获取药监码")]):e._e()],1),n("v-uni-view",{staticClass:"uni-flex",staticStyle:{height:"auto"}},[n("v-uni-view",{staticClass:"uni-flex-item",staticStyle:{color:"#e60012",padding:"5rpx 20rpx","font-size":"12px"}},[e._v("注：超过100条时，请分批保存")]),e.scanCodeLists.length>0?n("v-uni-view",{staticStyle:{"padding-right":"20rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleShowCode.apply(void 0,arguments)}}},[e._v("已扫"+e._s(e.barcodeMap[e.barcodeType])+">")]):e._e()],1),n("v-uni-view",{staticClass:"scan-box"},[e.scanNumber?n("v-uni-view",{staticClass:"scan-more f-primary",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleShowMore.apply(void 0,arguments)}}},[e._v("查看更多>>")]):e._e(),n("v-uni-view",{staticClass:"scan-number"},[n("v-uni-text",[e._v(e._s(e.scanNumber+"/"+e.allScanNumber))]),e.isShowError?n("v-uni-text",{staticStyle:{color:"#e60012","font-size":"12px","margin-left":"20rpx","margin-top":"-4rpx"}},[e._v("前7位异常")]):e._e()],1),n("rf-table",{attrs:{columns:e.scanColumns,"table-data":e.codeListShow},scopedSlots:e._u([{key:"operation",fn:function(t){var a=t.item;return[n("v-uni-button",{staticClass:"table-opeartion-button",attrs:{size:"mini",type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDelete(a)}}},[e._v("删除")])]}}])})],1)]],2),e.isCurrentScanComplete?e._e():n("template",{slot:"footer"},[n("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClear.apply(void 0,arguments)}}},[e._v("清空")]),e.allScanNumber>e.scanNumber&&"1"===e.$system.system?n("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmitBefore.apply(void 0,arguments)}}},[e._v("临时保存")]):e._e(),e.allScanNumber===e.scanNumber?n("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSubmitBefore.apply(void 0,arguments)}}},[e._v("保存")]):e._e()],1),n("uni-popup",{ref:"wnmPopup",attrs:{type:"dialog"}},[n("uni-popup-dialog",{attrs:{title:"万能码采集原因",duration:2e3,"before-close":!0,showClose:!1},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.onWnmConfirm.apply(void 0,arguments)}}},[n("v-uni-radio-group",{staticClass:"reasons",attrs:{slot:"content"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.handleRadioChange.apply(void 0,arguments)}},slot:"content"},e._l(["外包装无码","拆零无码","包装破损","数量差异","强制扫码"],(function(t,a){return n("v-uni-label",{key:t,staticClass:"radio"},[n("v-uni-radio",{attrs:{value:t,checked:e.reason===t}}),e._v(e._s(t))],1)})),1)],1)],1),n("uni-drawer",{ref:"scanPopup",staticClass:"full-uni-drawer",attrs:{mode:"right","mask-click":!0,width:"90%"}},[n("v-uni-view",{staticClass:"uni-flex uni-column"},[n("v-uni-view",{staticClass:"f-36 f-b t-c p-t-20 p-b-20 uni-flex",staticStyle:{height:"auto"}},[n("uni-icons",{staticClass:"drawer-close f-n",attrs:{type:"arrowleft",size:"24"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCloseScan.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"uni-flex-item",staticStyle:{"text-align":"center"}},[e._v("已扫"+e._s(e.barcodeMap[e.barcodeType]))])],1),n("v-uni-scroll-view",{staticClass:"uni-flex-item",staticStyle:{overflow:"auto"},attrs:{"scroll-y":"true"}},[n("v-uni-view",[n("rf-table",{staticClass:"m-r-20 m-l-20 scan-delete",attrs:{columns:e.scanColumns,"table-data":e.scanCodeLists},scopedSlots:e._u([{key:"operation",fn:function(t){var a=t.item;return[n("v-uni-button",{staticClass:"table-opeartion-button",attrs:{size:"mini",type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleTableListDelete(a)}}},[e._v("删除")])]}}])})],1)],1),n("v-uni-view",{staticClass:"uni-flex",staticStyle:{height:"auto"}},[n("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleCloseScan.apply(void 0,arguments)}}},[e._v("关闭")]),n("v-uni-button",{staticClass:"uni-flex-item bottom-button-item",attrs:{type:"warn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDeleteScan.apply(void 0,arguments)}}},[e._v("删除")])],1)],1)],1),n("uni-popup",{ref:"errPopup",attrs:{type:"dialog"}},[n("uni-popup-dialog",{attrs:{content:"条码中存在不一致的前7位码, 请仔细检查! 如果确定没有问题, 请点击[是]继续",duration:2e3,type:"info",confirmText:"是",cancelText:"否"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.onErrPopupConfirm.apply(void 0,arguments)}}})],1)],2)},o=[]},"14ba":function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("a649")),o=a(n("4c34")),s=function(e){return{BIZTRANSACTIONID:e,COUNT:"",CONSUMER:"10061",SRVLEVEL:"",ACCOUNT:"10061",PASSWORD:"",PAGENUM:"",PAGESIZE:"",MODULE:""}},r={instockQuery:function(e,t){var n=t["InformNo"]+"in"+Date.now(),a={REQUEST:{HEAD:s(n),LIST:[t]}};return(0,i.default)(o.default.INCA_PF_HOST+e,a).then((function(e){return e}))},outstockQuery:function(e,t){var n=t["OutformNo"]+"out"+Date.now(),a={REQUEST:{HEAD:s(n),LIST:[t]}};return(0,i.default)(o.default.INCA_PF_HOST+e,a).then((function(e){return e}))},scanfeedback:function(e,t){var n="scanfeedback"+Date.now(),a={REQUEST:{HEAD:s(n),LIST:[t]}};return(0,i.default)(o.default.CQP_ERP_PF_HOST+e,a).then((function(e){return e}))},savetmpinfo:function(e,t){var n="savetmpinfo"+Date.now(),a={REQUEST:{HEAD:s(n),LIST:[t]}};return(0,i.default)(o.default.CQP_ERP_PF_HOST+e,a).then((function(e){return e}))},querytmpinfo:function(e,t){var n="querytmpinfo"+Date.now(),a={REQUEST:{HEAD:s(n),LIST:[t]}};return(0,i.default)(o.default.CQP_ERP_PF_HOST+e,a).then((function(e){return e}))}};t.default=r},"1b32":function(e,t,n){"use strict";n.r(t);var a=n("b8f1"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},"1ea9":function(e,t,n){"use strict";var a=n("a6f6"),i=n.n(a);i.a},"2bf0":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.empty-wrap[data-v-0e304822]{height:100%;text-align:center}',""]),e.exports=t},"3d7e":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"segmented-control",class:["text"===e.styleType?"segmented-control--text":"segmented-control--button"],style:{borderColor:"text"===e.styleType?"":e.activeColor}},e._l(e.values,(function(t,a){return n("v-uni-view",{key:a,staticClass:"segmented-control__item",class:["text"===e.styleType?"segmented-control__item--text":"segmented-control__item--button",a===e.currentIndex&&"button"===e.styleType?"segmented-control__item--button--active":"",0===a&&"button"===e.styleType?"segmented-control__item--button--first":"",a===e.values.length-1&&"button"===e.styleType?"segmented-control__item--button--last":""],style:{backgroundColor:a===e.currentIndex&&"button"===e.styleType?e.activeColor:"",borderColor:a===e.currentIndex&&"text"===e.styleType||"button"===e.styleType?e.activeColor:"transparent"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._onClick(a)}}},[n("v-uni-text",{staticClass:"segmented-control__text",style:{color:a===e.currentIndex?"text"===e.styleType?e.activeColor:"#fff":"text"===e.styleType?"#000":e.activeColor}},[e._v(e._s(t))])],1)})),1)},i=[]},4987:function(e,t,n){"use strict";var a=n("c1de"),i=n.n(a);i.a},"4e75":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".segmented-control[data-v-1ac1f2bf]{\ndisplay:flex;box-sizing:border-box;\nflex-direction:row;height:36px;overflow:hidden}.segmented-control__item[data-v-1ac1f2bf]{\ndisplay:inline-flex;box-sizing:border-box;\nposition:relative;flex:1;justify-content:center;align-items:center}.segmented-control__item--button[data-v-1ac1f2bf]{border-style:solid;border-top-width:1px;border-bottom-width:1px;border-right-width:1px;border-left-width:0}.segmented-control__item--button--first[data-v-1ac1f2bf]{border-left-width:1px;border-top-left-radius:5px;border-bottom-left-radius:5px}.segmented-control__item--button--last[data-v-1ac1f2bf]{border-top-right-radius:5px;border-bottom-right-radius:5px}.segmented-control__item--text[data-v-1ac1f2bf]{border-bottom-style:solid;border-bottom-width:3px}.segmented-control__text[data-v-1ac1f2bf]{font-size:16px;line-height:20px;text-align:center}",""]),e.exports=t},"5b58":function(e,t,n){"use strict";n.r(t);var a=n("6976"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},6976:function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("64aa");var a={name:"UniSegmentedControl",props:{current:{type:Number,default:0},values:{type:Array,default:function(){return[]}},activeColor:{type:String,default:"#007d34"},styleType:{type:String,default:"button"}},data:function(){return{currentIndex:0}},watch:{current:function(e){e!==this.currentIndex&&(this.currentIndex=e)}},created:function(){this.currentIndex=this.current},methods:{_onClick:function(e){this.currentIndex!==e&&(this.currentIndex=e,this.$emit("clickItem",{currentIndex:e}))}}};t.default=a},7979:function(e,t,n){"use strict";n.r(t);var a=n("1091"),i=n("1b32");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("d48f");var s=n("828b"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"930e5f14",null,!1,a["a"],void 0);t["default"]=r.exports},"80b7":function(e,t,n){"use strict";n.r(t);var a=n("d3a7"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},a649:function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("4626"),n("5ac7"),n("c223"),n("bf0f"),n("d4b5"),n("f7a5");a(n("4c34"));var i=n("8b8c"),o=n("b439"),s=a(n("8c96")),r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",a=arguments.length>3?arguments[3]:void 0,r=(0,o.getData)("userInfo")||"",c=(0,o.getData)("loginInfo")||"",u=e.includes("http:")||e.includes("https:")?e:"http://".concat((0,o.getData)("serverInfo").ServerIP).concat(e);return!a&&(0,i.showLoading)(),new Promise((function(e,a){uni.request({url:u,data:JSON.stringify(t),sslVerify:!1,method:n,header:{"Content-type":"application/json;charset=UTF-8",CompanyID:r&&r.CompanyID||c.CompanyID||"",version:s.default&&s.default.AppInfo&&s.default.AppInfo.version||"","out-system-sign":(null===c||void 0===c?void 0:c.Sign)||void 0},complete:function(t){if((0,i.hideLoading)(),401==t.statusCode)return uni.removeStorage({key:"userInfo"}),(0,o.clear)("loginInfo"),uni.showToast({title:"登录失效，请重新登录！",icon:"none",position:"top",duration:2e3}),void setTimeout((function(){var e=getCurrentPages(),t=e[e.length-1].route;console.log("当前页面路径:",t),(null===t||void 0===t||!t.includes("/login/index"))&&uni.reLaunch({url:"/pages/login/index"})}),2e3);if(200==t.statusCode){var n=t.data.RESPONSE;n.HEAD&&0==n.HEAD.RESULT?e(n):a(n.HEAD.COMMENTS||"出错了，请联系管理员")}else{var s,r,c,u,d="请求失败，".concat(t.statusCode," ").concat(null===t||void 0===t||null===(s=t.data)||void 0===s||null===(r=s.message)||void 0===r?void 0:r.slice(0,100)).concat((null===t||void 0===t||null===(c=t.data)||void 0===c||null===(u=c.message)||void 0===u?void 0:u.length)>100?"...":"");a(d)}}})}))};t.default=r},a6f6:function(e,t,n){var a=n("2bf0");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("b5c31758",a,!0,{sourceMap:!1,shadowMode:!1})},afd2:function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.scan-delete[data-v-930e5f14] {height:100%}.scan-delete[data-v-930e5f14] .tbody{height:calc(100% - %?50?%);max-height:calc(100% - %?50?%)}.barcode-type[data-v-930e5f14]{padding:%?10?% %?20?%}.barcode-type[data-v-930e5f14] .segmented-control{height:26px}.barcode-type[data-v-930e5f14] .segmented-control .segmented-control__text{font-size:14px}.drug-code-wrap[data-v-930e5f14] .drug-code-card{overflow:inherit;z-index:99;margin-top:0}.drug-code-wrap[data-v-930e5f14] .drug-code-card .item-info{align-items:center;font-size:14px;color:#333}.drug-code-wrap[data-v-930e5f14] .drug-code-card .item-info .uni-combox{height:100%}.drug-code-wrap[data-v-930e5f14] .drug-code-card .item-info .uni-combox .uni-combox__label{font-size:14px;color:#333}.drug-code-wrap[data-v-930e5f14] .drug-code-card .item-info .uni-combox .uni-combox__input{font-size:14px}.drug-code-wrap[data-v-930e5f14] .drug-code-card .item-info .uni-combox__input-arrow{padding:2px}.drug-code-wrap[data-v-930e5f14] .scan-box{margin:%?10?% %?20?%;word-break:break-all;position:relative;padding-bottom:%?70?%}.drug-code-wrap[data-v-930e5f14] .scan-box .scan-number{position:absolute;bottom:%?10?%;left:%?10?%;text-align:center}.drug-code-wrap[data-v-930e5f14] .scan-box .scan-more{position:absolute;bottom:%?10?%;right:%?10?%}.drug-code-wrap[data-v-930e5f14] .reasons{padding:%?10?% 0}.drug-code-wrap[data-v-930e5f14] .reasons .radio{display:block;padding:%?10?% %?40?%}.drug-code-wrap[data-v-930e5f14] .reasons .radio uni-radio .uni-radio-input{margin-right:%?30?%;margin-top:%?-8?%}',""]),e.exports=t},b8f1:function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("aa77"),n("bf0f"),n("2797"),n("64aa"),n("473f"),n("f7a5"),n("dc69"),n("c223"),n("8f71"),n("5c47"),n("0506"),n("bd06"),n("aa9c"),n("fd3c"),n("dc8a");var i=a(n("39d8")),o=a(n("9b1b")),s=a(n("b7c7")),r=a(n("4d76")),c=a(n("69ec")),u=a(n("9a9a")),d=a(n("b93a")),l=a(n("ceba")),f=a(n("14ba")),p=a(n("5885")),h=a(n("a347")),v=n("8f59"),m=n("1f2e"),g={name:"drugCode",data:function(){return{isDelete:!1,reason:"",packType:"小",sl:1,drugCode:"",codeList:[],pageData:"",barcodeMap:["药监码","箱序码","器械唯一码"],barcodeType:0,scanColumns:[{name:"条码",dataIndex:"BarCode"},{name:"类型",dataIndex:"Package",width:100},{name:"数量",dataIndex:"PackageSize",width:100},{name:"万能码采集原因",dataIndex:"Wnmyy",hidden:!0,width:120},{name:"操作",dataIndex:"operation",width:120}],focusField:{sl:!1,drugCode:!1},superBarCode:"99999999999999999999"}},onShow:function(e,t){var n=this;if(this.codeList=this.codeListStore&&(0,s.default)(this.codeListStore)||[],this.scanCodeInfo&&this.scanCodeInfo.codeLists.length>0){this.codeList=this.scanCodeInfo.codeLists;var a=this.codeList.find((function(e){return e.BarCode===n.superBarCode}));a&&!a.Wnmyy&&this.$refs.wnmPopup.open()}this.clearScanCodeInfo(),this.setCodeLists([])},onHide:function(){this.setCodeLists(this.codeList)},computed:(0,o.default)((0,o.default)({},(0,v.mapGetters)({casesPickInfo:"casesPickInfo",userInfo:"userInfo",codeListStore:"codeList",scanCodeInfo:"scanCodeInfo"})),{},{label:function(){return this.$getOrderTypeName(this.casesPickInfo.orderType)+"ID"},allScanNumber:function(){var e=0;return this.pageData&&this.pageData.CHILD_TABLE_LIST.length>0&&this.pageData.CHILD_TABLE_LIST.forEach((function(t){e+=Number(t.PackageSize)})),this.casesPickInfo["Quantity"]-e},scanNumber:function(){return this.codeList.reduce((function(e,t){return e+Number(t.PackageSize||0)}),0)},codeListShow:function(){var e=this.codeList;return e.reverse().slice(0,50)},scanCodeLists:function(){return this.pageData&&this.pageData.CHILD_TABLE_LIST||[]},isShowError:function(){var e,t,n,a,i,o,r,c=this;if(0!=this.barcodeType)return!1;var u=[].concat((0,s.default)(this.codeList||[]),(0,s.default)((null===(e=this.pageData)||void 0===e?void 0:e.CHILD_TABLE_LIST)||[])),d=u.filter((function(e){return e.BarCode!==c.superBarCode}));if(null===d||void 0===d||!d.length)return!1;for(var l={packageMin:"",packageMax:"",packageMid:""},f=0;f<d.length;f++){var p=d[f],h="小"==p.Package?"packageMin":"大"===p.Package?"packageMax":"packageMid",v=p.BarCode.slice(0,7);if(""!=l[h]){if(l[h]!==v)return!0}else l[h]=v}return!!(null!==(t=l.packageMin)&&void 0!==t&&t.length&&null!==(n=l.packageMax)&&void 0!==n&&n.length&&l.packageMin===l.packageMax||null!==(a=l.packageMin)&&void 0!==a&&a.length&&null!==(i=l.packageMid)&&void 0!==i&&i.length&&l.packageMin===l.packageMid||null!==(o=l.packageMid)&&void 0!==o&&o.length&&null!==(r=l.packageMax)&&void 0!==r&&r.length&&l.packageMid===l.packageMax)},isCurrentScanComplete:function(){return 0==this.barcodeType?"1"==this.casesPickInfo.ScanComplete||"0"==this.casesPickInfo.Dzjgmbz:1==this.barcodeType?"1"==this.casesPickInfo.XxmScanComplete||"0"==this.casesPickInfo.Xxmbz:2==this.barcodeType?"1"==this.casesPickInfo.WymScanComplete||"0"==this.casesPickInfo.Qxwymbz:void 0}}),components:{uniCard:r.default,uniCombox:c.default,uniBadge:u.default,uniTag:d.default,uniPopup:p.default,uniPopupDialog:h.default},onBackPress:function(e){var t=this;return"navigateBack"!==e.from&&(this.$showModel({showCancel:!0,message:"确认退出操作？",success:function(){t.$back()}}),!0)},watch:{},created:function(){var e=this.casesPickInfo,t=e.Dzjgmbz,n=e.Qxwymbz,a=e.Xxmbz,i=e.ScanComplete,o=e.WymScanComplete,s=e.XxmScanComplete;"1"==t&&"1"!=i?this.barcodeType=0:"1"==a&&"1"!=s?this.barcodeType=1:"1"==n&&"1"!=o&&(this.barcodeType=2),this.loadData()},methods:(0,o.default)((0,o.default)({},(0,v.mapActions)({setCasesPickInfo:"setCasesPickInfo",setCodeLists:"setCodeLists",setScanCodeInfo:"setScanCodeInfo",clearScanCodeInfo:"clearScanCodeInfo"})),{},{onChangeBarcodeType:function(e){var t=e.currentIndex;this.barcodeType=t,this.loadData()},goScan:function(){this.clearScanCodeInfo(),this.sl?(this.setScanCodeInfo({codeLists:this.codeList||[],allScanNumber:this.allScanNumber,count:"小"!==this.packType?Number(this.sl):1,picktype:"1",package:this.packType,sacnCodeLists:this.pageData&&this.pageData.CHILD_TABLE_LIST||[]}),this.$navigateTo("/pages/rferp/scanCode")):this.$simpleToast("请输入包装数")},handleShowMore:function(){this.setCodeLists(this.codeList),this.$navigateTo("/pages/rferp/code")},loadData:function(){var e=this;this.packType=this.casesPickInfo.Quantity%this.casesPickInfo.BigpackageNum===0?"大":"0"!==this.casesPickInfo.MidpackageNum?"中":"小",this.resetSl(this.packType),this.drugCode="",this.handleClear(),this.changeFocus("drugCode"),uni.setNavigationBarTitle({title:"扫描"+this.barcodeMap[this.barcodeType]});var t={LotId:this.casesPickInfo.LotId,OrderType:this.casesPickInfo.orderType,SourcNo:this.casesPickInfo.SourcNo,Sku:this.casesPickInfo.GoodsID,BarcodeType:this.barcodeType+1};f.default.querytmpinfo(this.$system.querytmpinfo,t).then((function(t){if(0==t.HEAD.ERRORCODE){var n,a;e.pageData=t.LIST[0];var i=null===(n=e.pageData)||void 0===n||null===(a=n.CHILD_TABLE_LIST)||void 0===a?void 0:a.find((function(t){return t.BarCode===e.superBarCode}));if(i){var o=e.scanColumns.find((function(e){return"Wnmyy"===e.dataIndex}));o.hidden=!1}e.$forceUpdate()}else e.$simpleToast(t.HEAD.ERRORINFO)}))},onWnmConfirm:function(e){var t=this;if(this.reason){var n=this.codeList.find((function(e){return e.BarCode===t.superBarCode&&!e.Wnmyy}));n.Wnmyy=this.reason;var a=this.scanColumns.find((function(e){return"Wnmyy"===e.dataIndex}));a.hidden=!1,this.$forceUpdate(),e(),this.reason=""}else this.$simpleToast("请选择万能码采集原因")},handleDelete:function(e){if(e.BarCode===this.superBarCode){var t=this.scanColumns.find((function(e){return"Wnmyy"===e.dataIndex}));t.hidden=!0}this.codeList=this.codeList.filter((function(t){return t.BarCode!==e.BarCode}))},handleSlInput:function(e){var t=this;e<0&&(this.$simpleToast("包装数必须大于0"),setTimeout((function(){t.sl=""})))},handleCodeChange:function(e){if(this.sl)return e.value===this.superBarCode?(this.sl=this.allScanNumber-this.scanNumber,void this.groupCodeData(e)):void(this.sl>this.allScanNumber-this.scanNumber?this.$simpleToast("包装数不能大于可扫描数量"):this.groupCodeData(e));this.$simpleToast("请输入包装数")},groupCodeData:function(e){var t=this,n=this.pageData&&this.pageData.CHILD_TABLE_LIST||[];if(0==this.barcodeType){if(!/^[\d]{20}$/.test(e.value))return this.handleErrorVideo(),void this.$simpleToast(this.barcodeMap[this.barcodeType]+"格式错误")}if((n.length<=0||n.findIndex((function(t){return t.BarCode===e.value}))<=-1)&&this.codeList.findIndex((function(t){return t.BarCode===e.value}))<=-1){var a,i={BarCode:e.value,PackageSize:"小"!==this.packType||e.value==this.superBarCode?Number(this.sl):1,Package:this.packType,UserId:null===(a=this.userInfo)||void 0===a?void 0:a.UserID,ScanTime:this.getScantimeStr()};this.codeList.push(i),this.superBarCode===e.value&&this.$refs.wnmPopup.open()}else this.handleErrorVideo(),!this.isDelete&&this.$simpleToast(e.value+"已扫描"),this.isDelete&&this.$showModel({showCancel:!0,message:"确认删除".concat(this.barcodeMap[this.barcodeType]).concat(e.value,"？"),success:function(){t.codeList=t.codeList.filter((function(t){return t.BarCode!==e.value}))}});setTimeout((function(){t[e.currentType]=""}))},handleTempSubmit:function(){var e=this,t=this.getPostTempData(),n=this.$system.savetmpinfo;f.default.savetmpinfo(n,t).then((function(t){0!=t.HEAD.ERRORCODE&&1!=t.HEAD.RESULT&&t.HEAD.ERRORCODE?e.$simpleToast(t.HEAD.ERRORINFO):(e.$simpleToast("保存成功"),e.reason="",e.pageData.CHILD_TABLE_LIST=[].concat((0,s.default)(e.pageData.CHILD_TABLE_LIST),(0,s.default)(e.codeList)),e.handleClear(),setTimeout((function(){e.focusField.drugCode=!0}),200),e.setCasesPickInfo({isSave:!0}))}))},getPostTempData:function(){var e,t,n=(0,s.default)(this.codeList||[]);return(null===(e=this.pageData)||void 0===e||null===(t=e.CHILD_TABLE_LIST)||void 0===t?void 0:t.length)>0&&n.push.apply(n,(0,s.default)(this.pageData.CHILD_TABLE_LIST)),{OwnerId:this.casesPickInfo.Owner,OrderType:this.casesPickInfo.orderType,SourcNo:this.casesPickInfo.SourcNo,Sku:this.casesPickInfo.GoodsID,LotId:this.casesPickInfo.LotId,CHILD_TABLE_LIST:n,BarcodeType:this.barcodeType+1}},getPostData:function(){var e,t,n=this,a=this.$getInOutTypeDictItemByLabel(this.casesPickInfo.typeName),i=(0,s.default)(this.codeList||[]);(null===(e=this.pageData)||void 0===e||null===(t=e.CHILD_TABLE_LIST)||void 0===t?void 0:t.length)>0&&i.push.apply(i,(0,s.default)(this.pageData.CHILD_TABLE_LIST));var o=this.lodash.cloneDeep(i);return o.map((function(e){e.Package=n.$getPackTypeToERP(e.Package)})),{Iodtlid:this.casesPickInfo.Iodtlid||"",InOut:"out"===this.casesPickInfo.type?0:1,Formtype:this.casesPickInfo.formType,OutStockNum:this.casesPickInfo.orderId,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Owner:this.casesPickInfo.Owner,ScanComplete:"1",InOutType:a.value,OrderType:this.casesPickInfo.orderType,SourcNo:this.casesPickInfo.SourcNo,LotId:this.casesPickInfo.LotId,StockId:this.casesPickInfo.StockId,Supplier:this.casesPickInfo.Supplier,OperationType:this.casesPickInfo.formType,BarcodeType:this.barcodeType+1,Remark:"RF采码",CHILD_TABLE_LIST:o}},handleSubmit:function(){var e=this,t=this.$system.scanfeedback,n=this.getPostData();f.default.scanfeedback(t,n).then((function(t){var n;0!=t.HEAD.ERRORCODE&&t.HEAD.ERRORCODE?e.$simpleToast(t.HEAD.ERRORINFO):(e.reason="",e.$simpleToast("保存成功"),e.setCasesPickInfo((n={},(0,i.default)(n,["ScanComplete","XxmScanComplete","WymScanComplete"][e.barcodeType],"1"),(0,i.default)(n,"isSave",!0),n)),e.$nextTick((function(){var t=e.casesPickInfo,n=t.Dzjgmbz,a=t.Qxwymbz,i=t.Xxmbz,o=t.ScanComplete,s=t.WymScanComplete,r=t.XxmScanComplete,c=0;"1"==n&&c++,"1"==a&&c++,"1"==i&&c++;var u=0;"1"==n&&"1"==o&&u++,"1"==a&&"1"==s&&u++,"1"==i&&"1"==r&&u++,u==c&&e.$back()})))})).catch((function(t){e.$simpleToast(t)}))},handleSubmitBefore:function(){this.isShowError?this.$refs.errPopup.open():this.onErrPopupConfirm()},onErrPopupConfirm:function(){this.$refs.errPopup.close(),this.allScanNumber>this.scanNumber?this.handleTempSubmit():this.handleSubmit()},handleClear:function(){this.codeList=[],this.isDelete=!1},handleErrorVideo:function(){var e=uni.createInnerAudioContext();e.autoplay=!0,e.src="../../static/video/error.mp3",e.onPlay((function(){console.log("开始播放")})),e.onError((function(e){console.log(e.errMsg),console.log(e.errCode)}))},getScantimeStr:function(){var e=function(e){return e<10?"0"+e:e},t=new Date,n=t.getFullYear(),a=t.getMonth()+1,i=t.getDate(),o=t.getHours(),s=t.getMinutes(),r=t.getSeconds();return a>12&&(a-=12),"".concat(n,"-").concat(e(a),"-").concat(e(i)," ").concat(e(o),":").concat(e(s),":").concat(e(r))},handleSelectPackageType:function(e){this.resetSl(e),"小"===e||"0"!==this.casesPickInfo.MidpackageNum&&"0"!==this.casesPickInfo.BigpackageNum||this.changeFocus("sl")},resetSl:function(e){"中"===e?(this.casesPickInfo.Quantity,this.casesPickInfo.MidpackageNum,this.sl=Number(this.casesPickInfo.MidpackageNum)):"大"===e?(this.casesPickInfo.Quantity,this.casesPickInfo.BigpackageNum,this.sl=Number(this.casesPickInfo.BigpackageNum)):this.sl=1},changeFocus:function(e){var t=this;this.$nextTick((function(){Object.keys(t.focusField).forEach((function(n){t.focusField[n]=n===e}))}))},handleRadioChange:function(e){this.reason=e.target.value},handleComBoxClose:function(){var e;null===(e=this.$refs.combox)||void 0===e||e.onBlur()},handleShowCode:function(){this.$refs.scanPopup.open()},handleCloseScan:function(){this.$refs.scanPopup.close()},handleDeleteScan:function(){this.pageData.CHILD_TABLE_LIST=[],this.$forceUpdate()},handleTableListDelete:function(e){this.pageData.CHILD_TABLE_LIST=this.pageData.CHILD_TABLE_LIST.filter((function(t){return t.BarCode!==e.BarCode}))},GetOwnerYjm:function(){var e=this;l.default.GetOwnerYjm({OutStockNo:this.casesPickInfo.SupplierSONO,GoodsID:this.casesPickInfo.GoodsID,GoodsBatch:this.casesPickInfo.GoodsBatch,Owner:this.casesPickInfo.SupplierOwner}).then((function(t){e.codeList=[];var n=e.pageData&&e.pageData.CHILD_TABLE_LIST||[];t.ScanSum_YJM.length>0&&t.ScanSum_YJM.forEach((function(t){var n={BarCode:t.barcode,PackageSize:t.sl,Package:t.package,UserId:e.userInfo.UserID,ScanTime:e.getScantimeStr()};e.codeList.push(n)})),e.codeList=(0,m.getResultArray)("BarCode","difference",e.codeList,n),e.codeList.length>0&&(e.isDelete=!0)}))}})};t.default=g},ba77:function(e,t,n){"use strict";n.r(t);var a=n("def7"),i=n("80b7");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("1ea9");var s=n("828b"),r=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"0e304822",null,!1,a["a"],void 0);t["default"]=r.exports},c1de:function(e,t,n){var a=n("4e75");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("4dc64590",a,!0,{sourceMap:!1,shadowMode:!1})},c366:function(e,t,n){var a=n("afd2");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("176d706c",a,!0,{sourceMap:!1,shadowMode:!1})},d3a7:function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={name:"empty",props:{emptyText:{type:String,default:"暂无数据"}}};t.default=a},d48f:function(e,t,n){"use strict";var a=n("c366"),i=n.n(a);i.a},def7:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"empty-wrap VM"},[t("v-uni-view",{staticClass:"VMC"},[this._v(this._s(this.emptyText))])],1)},i=[]}}]);